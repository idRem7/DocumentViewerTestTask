
# Тестовое задание

Необходимо создать приложение для просмотра документов и добавления аннотаций.

Детали:

+ Задание должно быть выполнено на фреймворке Angular без использования
дополнительных сторонних библиотек, за исключением ui китов вроде Taiga,
Angular Material и тп. Стейт менеджер не требуется. (Angular CDK Drag-n-Drop нельзя)
+ Пользователь открывает документ по ссылке, в которой есть id документа.
Список документов не требуется, будем считать, что пользователь получил
прямую ссылку на документ.
+ Приложение получает информацию о документе по API, в которой указаны
страницы со ссылками на изображения (смотрите приложенный json, его
используйте как мокап). Изображения - это страницы документа, пользователь
имеет возможность скроллить документ вниз для просмотра всех страниц.
+ Документ может быть увеличен или уменьшен (zoom) кнопками “+” и “-”.
+ Пользователь может добавлять аннотации в виде текста.
+ Добавленные аннотации можно перемещать. Перемещение должно быть
реализовано самостоятельно без использования библиотек. (Angular CDK Drag-n-Drop нельзя)
+ Можно также удалять аннотации.
+ Должна быть кнопка “Сохранить”, при нажатии на которую в консоль выводится
информация о документе с добавленными аннотациями.
+ Дизайн произвольный, не учитывается при рассмотрении работы, хотя
плавность интерфейса будет плюсом.

Ожидаемый результат:

+ Предоставьте исходный код (желательно на github)
+ В README.md опишите плюсы и минусы реализации, известные проблемы и
способы решения

В первую очередь, мы проверяем умение писать чистый и понятный код. Функционал
вторичен, но грубые баги интерфейса тоже не допустимы, так как это тоже результат
умения программировать.

# Решение

## Запуск

Установите NodeJS, Node modules и запускайте как обычно запускаете Angular-приложение. У меня на локальной машине все работает.

## Зависимости

+ Angular 20 и все пакеты, которые идут к нему
+ ts-serializable для сереализации / десериализации моделей
+ reflect-metadata нужен для ts-serializable

### dev-зависимости

Для обеспечения качества и красоты кода были добавлены линтеры и стайлеры, конфиги к ним так же настроены и уже есть в проекте. В файле пакетов так же есть команды для запуска.

+ Eslint
+ Prettier
+ Stylelint

## Решение

### Общая информация

В коде будут встречаться комментарии, в которых описываются причины, почему написан тот или иной фрагмент кода. Так же некоторые комменнтарии описывают преимущества и недостатки, и то, как надо и почему.

Все решение было сделано в одной ветке, не покрасоте git-flow, но для тестового задния это избыток. На реальном проекте это конечно нужно.

### Реализация

#### Архитектура
Решение задачи выполнено в виде ангуляр-модуля, как если бы это была часть большого приложения. Различные сущности были вынесены в плоскую структуру папок (кроме компонентов).

Модуль имеет главный компонент страницы приложения (не путать со старницой документа) , который собирает ее из компонентов-блоков. Все блоки сделаны чистыми компонентами, которые принимают данные в пропсах, и выбрасывают события, занимаются только вьюшками. Никаких побочных вещей, зависимостей, действий. Исключение только для компонента страницы документа, он применяет Drag-n-Drop, но это тоже UI штука.

Модели данных вынесены в отдельные сущности. Для взаимодействия с сервером используется сервис. В данной реализации теоретически представлен сервис, как он взаимодействует с сервером. Но так как у нас мок-данные и мок-сохранение сделан стаб-сервис, который инжектится в страницу приложения с помощью подмены DI.

Начальная загрузка данных вынесена в резолвер. Управление стейтом сделано в странице приложения, но обычно такое выносят в стор (стейт-менеджер).

В итоге получаем чистую структуру, где каждый элемент занимается своими делаеми. Между элементами правильные зависимости, конкретика зависит от абстракции, правильный поток данных. Вью-компоненты обладают высокой степенью переиспользуемости.

#### Реализация Drag-n-Drop

Данный функционал был реализован с помощью директив, что по сути хорошо, для переиспользования. Данные директивы имеют только одну ответственность - это drag-n-drop и не учитывают конкретные реализации компонентов, с которыми они будут работать.

Под капотом директивы используют браузерное Api, позиционирование осуществляется вручную с использованием различных событий и координат.

##### Плюсы реализации
+ Нет зависимостей от сторонних библиотек и зависимостей библиотек
+ Нет ограничения на реализацию до функционала (плюсом хорошая адаптация под нужды проекта). Библиотеки же предоставляют определенный набор функционала, но ничего больше.
+ Реализация с помощью директив не привязывается к конкретике и хорошо переиспользуется
+ Если в библиотеке есть баг, то для его фикса нужно заводить тикет в пакет и ждать фикса. Кастомная реализация позволяет сразу начать багфикс
+ Размер бандла может быть меньше, чем с использованием библиотек
+ Доступность исходного кода позволяет лучше понять поведение (белый ящик). Конечно можно почитать исходный код библиотек, но на это уйдет больше времени

#### Минусы
+ Все нужно делать вручную, высокий порог вхождения. Для разработчиков начального и среднего уровня добавление функционала и багфикс может стать непростой задачей.
+ Для разработки директив нужно потратить время, применить библиотеку куда быстрее
+ В данной реализации немного хромает скролл, нужно потратить время на исследование и реализацию нормального скролла
+ Скорее библиотеки уже адаптивны для различных устройств и тач-скринов, тут это нужно делать отдельно

#### Известные решения

+ Использовать браузерные события для DnD, но они плохо работают, есть нежелательно поведение. Почти все библиотеки все делают вручную
+ Angular/CDK/Drag-n-Drop: очень классная библиотека с большим функционалом. Можно легко и просто сделать то, что нужно. Но нет поддержки переноса для двухмерных сеток, нужно писать доп. решение поверх библиотеки. Доступно только с ангуляром, в реакте уже не получится применить.

# Как пользоваться 

На главной странице одна ссылка, нажмите ее. Аннотации добавляются двойным кликом, редактировать текст тоже двойным кликом. Перетасивать как обычно. При сохранении данные выводятся в консоль. Ширина экрана не менее 800 пикселей в ширину, работает только на десктопе, тач-события не поддерживаются. Аннотации не масштабируются, но координаты подстраиваются под масштаб, в том числе при создании и перетаскивании. При перетаскивании реализован простой скролл по обеи осям. Нельзя перетаскивать на шапку страницы, а так же аннотация должна полносью помещаться в блоке страницы. Если отпустить аннотацию в запрещенном месте, то она вернется назад. При перемещении аннотации в запрещенную область она станет красной, в допустимой области она будет желтой. Аннотации можно перемещать между страницами. Остальные действия интуитивно понятные.
